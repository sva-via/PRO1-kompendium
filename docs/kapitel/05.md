# Kapitel 5 – Metoder og kontrolstrukturer

## 1. Introduktion

I denne del bevæger vi os fra designprincipper til implementering. Men implementering er et middel – ikke et mål.

Kontrolstrukturer som if/else og loops er værktøjer til at realisere et design. De må aldrig blive selve formålet med koden.

## 2. Faglig gennemgang

En metode skal understøtte klassens ansvar. if/else bruges til at træffe beslutninger, når invarianten eller domænelogikken kræver det.

```
public boolean isLeapYear(int year) {
    if (year % 400 == 0) {
        return true;
    } else if (year % 100 == 0) {
        return false;
    } else {
        return year % 4 == 0;
    }
}
```
Her anvendes betingelser til at implementere en præcis domæneregel.

Et loop anvendes, når vi gentager en veldefineret operation.

```
public int daysInMonth(int month) {
    int[] days = {31,28,31,30,31,30,31,31,30,31,30,31};
    return days[month - 1];
}
```
Loops og betingelser skal udspringe af modellens behov – ikke af ønsket om at bruge sprogets features.

## 3. Gennemgående eksempel – MyDate

```
public boolean isBefore(MyDate other) {

    if (this.year != other.year) {
        return this.year < other.year;
    }

    if (this.month != other.month) {
        return this.month < other.month;
    }

    return this.day < other.day;
}
```
Metoden sammenligner to datoer ved systematisk at afklare forskelle. Kontrolstrukturen følger direkte af begrebets logik.

## 4. Kodeeksempler

```
public void stepForwardOneDay() {
    day++;
}
```
En naiv implementering er utilstrækkelig, hvis den ikke tager højde for månedsskifte.

```
public void stepForwardOneDay() {

    day++;

    if (!isValidDate(year, month, day)) {
        day = 1;
        month++;

        if (month > 12) {
            month = 1;
            year++;
        }
    }
}
```
Her anvendes if-strukturer for at bevare invarianten.

## 5. Designovervejelser

Kontrolstrukturer bør være en konsekvens af domænelogik. Hvis en metode bliver lang og kompleks, kan det indikere for mange ansvar.

Spørg altid: Implementerer vi en regel – eller skriver vi blot kode?

## 6. Typiske fejl og misforståelser

1) At skrive lange metoder uden klart formål.
2) At bruge loops hvor en simpel beregning er nok.
3) At ignorere invarianten i implementeringen.
4) At optimere før korrekthed.

## 7. Refleksionsspørgsmål

1) Hvordan afgør man, om en metode har ét klart ansvar?
2) Hvornår bliver en if/else-struktur tegn på designproblem?
3) Hvad betyder det, at implementering er et middel og ikke et mål?

## 8. Små øvelser

Øvelse 1: Implementér en metode i MyDate, der returnerer antal dage siden årets start.

Øvelse 2: Refaktorér en metode med flere nested if-statements til mindre hjælpe-metoder.
