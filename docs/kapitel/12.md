# Kapitel 12 – Simpel teststruktur

## 1. Introduktion

I forrige kapitel arbejdede vi med test som tænkning. I dette kapitel konkretiserer vi en simpel struktur for tests.

Vi fokuserer på tre centrale elementer: assertions, hvad vi tester, og hvordan vi tester exceptions.

## 2. Assertions

En assertion er en påstand om, hvad der skal være sandt. I Java kan vi bruge assert eller skrive simple kontroludtryk i en testmetode.

```
public void testIsBefore() {
    MyDate d1 = new MyDate(2024, 1, 1);
    MyDate d2 = new MyDate(2024, 1, 2);

    assert d1.isBefore(d2);
}
```
Assertionen udtrykker forventet adfærd. Hvis påstanden er falsk, er der en fejl i implementeringen.

## 3. Hvad tester vi?

Vi tester ikke private felter eller interne implementeringsdetaljer. Vi tester klassens offentlige adfærd.

Test bør fokusere på:
- Normal adfærd
- Edge cases
- Boundary values
- Invariants

```
public void testBoundaryMonth() {
    new MyDate(2024, 1, 1);   // gyldig
    new MyDate(2024, 12, 31); // gyldig
}
```
Hvis konstruktionen ikke kaster exception her, opfyldes grænsekravene.

## 4. Test af exceptions

Når en metode forventes at kaste en IllegalArgumentException, skal testen verificere dette.

```
public void testInvalidMonth() {
    try {
        new MyDate(2024, 13, 1);
        assert false;  // burde ikke nås
    } catch (IllegalArgumentException e) {
        assert true;
    }
}
```
Testen sikrer, at objektet beskytter sin invariant.

## 5. Gennemgående eksempel – Account

```
public class Account {

    private double balance;

    public Account(double initial) {
        if (initial < 0) {
            throw new IllegalArgumentException();
        }
        balance = initial;
    }

    public void withdraw(double amount) {
        if (amount > balance) {
            throw new IllegalStateException();
        }
        balance -= amount;
    }

    public double getBalance() {
        return balance;
    }
}
public void testWithdrawTooMuch() {
    Account a = new Account(100);

    try {
        a.withdraw(200);
        assert false;
    } catch (IllegalStateException e) {
        assert true;
    }
}
```
Her testes, at korrekt exception kastes, når objektets tilstand ikke tillader operationen.

## 6. Designovervejelser

En simpel teststruktur kan implementeres uden avancerede frameworks.

Vigtigt er klar struktur:
- Arrange (opret objekter)
- Act (udfør handling)
- Assert (kontrollér resultat)

## 7. Typiske fejl og misforståelser

1) At teste private felter direkte.
2) At undlade test af exceptions.
3) At skrive tests, der afhænger af rækkefølge.
4) At ignorere grænsetilfælde.

## 8. Refleksionsspørgsmål

1) Hvorfor bør tests fokusere på offentlig adfærd?
2) Hvordan tester man korrekt, at en exception kastes?
3) Hvad betyder det, at test er en del af designprocessen?

## 9. Små øvelser

Øvelse 1: Skriv tests for Temperature-klassen ved grænsen -273.15.

Øvelse 2: Design en test, der verificerer invariant i en Clock-klasse.
