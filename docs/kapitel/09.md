# Kapitel 9 – Samarbejdende objekter

## 1. Introduktion

I de foregående kapitler har vi set på enkeltstående klasser og relationer mellem dem. I dette kapitel flytter vi fokus til samarbejde: Hvordan arbejder objekter sammen?

Centrale spørgsmål er: Hvem kalder hvem? Hvor meget ved klasser om hinanden? Og hvordan opnår vi høj cohesion og lav coupling?

## 2. Faglig gennemgang

Når et objekt kalder en metode på et andet objekt, opstår der kobling (coupling). Coupling beskriver, hvor afhængige klasser er af hinanden.

Cohesion beskriver, hvor godt en klasse hænger sammen internt. En klasse med høj cohesion har metoder og felter, der naturligt hører sammen.

Målet i objektorienteret design er høj cohesion og lav coupling.

## 3. Hvem kalder hvem?

```
public class Person {

    private Name name;

    public Person(Name name) {
        this.name = name;
    }

    public String getFullName() {
        return name.getFullName();
    }
}
```
Her kalder Person metoden getFullName på Name. Ansvar delegeres til det objekt, der naturligt ejer logikken.

Et godt samarbejde betyder, at hver klasse udfører sin del af arbejdet – uden at kende interne detaljer hos andre.

## 4. Eksempel – Song og Time

```
public class Song {

    private Time duration;

    public Song(Time duration) {
        this.duration = duration;
    }

    public boolean isLongerThan(Song other) {
        return this.duration.getSeconds() > other.duration.getSeconds();
    }
}
```
Her samarbejder Song-objekter via deres Time-objekter. Song kender kun den offentlige metode getSeconds i Time.

## 5. Lav coupling

Lav coupling betyder, at ændringer i én klasse ikke tvinger ændringer i mange andre klasser.

Hvis Person direkte tilgår felter i Name, øges koblingen. Hvis Person kun bruger offentlige metoder, reduceres koblingen.

Coupling reduceres ved:
- At bruge indkapsling
- At delegere ansvar korrekt
- At undgå unødvendige afhængigheder

## 6. Cohesion (introduktion)

Høj cohesion betyder, at en klasse har ét klart formål.

Hvis en klasse både håndterer domænelogik, brugerinput og databaseadgang, er cohesion lav.

```
public class Account {

    private double balance;

    public void deposit(double amount) {
        balance += amount;
    }

    public void printToConsole() {
        System.out.println(balance);
    }
}
```
Her blandes domænelogik og præsentation. Det reducerer cohesion.

## 7. Designovervejelser

Godt samarbejde mellem objekter kræver klare ansvar og veldefinerede grænseflader.

Spørg altid:
- Hvem bør kende denne information?
- Hvem bør udføre denne handling?
- Kan afhængigheden reduceres?

## 8. Typiske fejl og misforståelser

1) At lade én klasse styre hele systemet.
2) At bryde indkapsling for at spare en metode.
3) At lade klasser kende hinandens interne felter.
4) At ignorere cohesion ved at samle for mange ansvar.

## 9. Refleksionsspørgsmål

1) Hvordan kan du afgøre, om coupling er for høj?
2) Hvad er forskellen på cohesion og coupling?
3) Hvornår bør en metode flyttes til en anden klasse?

## 10. Små øvelser

Øvelse 1: Refaktorér Account, så printToConsole flyttes ud af klassen.

Øvelse 2: Identificér i et eksisterende design, hvor ansvar kan delegeres tydeligere.
